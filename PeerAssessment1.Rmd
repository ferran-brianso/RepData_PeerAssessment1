---
title: "Reproducible Research: Peer Assessment 1"
author: "Ferran Brianso (ferran.brianso@vhir.org)"
date: "13/08/2015"
output: 
  html_document:
    keep_md: true
---

## General settings and library loadings

```{r}
echo = TRUE
library(ggplot2)
```

## Loading and preprocessing the data

Unzip and load csv file
```{r}
unzip("activity.zip")
data <- read.csv("activity.csv", header=TRUE)
```

Preprocess some fields and review the data
```{r}
data$interval <- as.factor(data$interval)
data$date <- as.Date(data$date)
head(data)
tail(data)
dim(data)
```

Subset those cases without NA
```{r}
data.woNA <- na.omit(data)
rownames(data.woNA) <- 1:nrow(data.woNA)
head(data.woNA)
tail(data.woNA)
dim(data.woNA)
```

## What is mean total number of steps taken per day?

Using data set without NAs for this part of the assignment.

Calculate the total number of steps taken per day
```{r}
steps.per.day <- aggregate(data.woNA$steps, list(Date=data.woNA$date), FUN="sum")
head(steps.per.day)
tail(steps.per.day)
```

Make a histogram of the total number of steps taken each day
```{r}
hist(steps.per.day$x, breaks=(length(steps.per.day$x)/3), col="orange",
     main="Histogram of steps per day", xlab="Steps per day")
```

Calculate and report the mean and median of the total number of steps taken per day
```{r}
mean(steps.per.day$x)
median(steps.per.day$x)
```

## What is the average daily activity pattern?

Time series plot of the 5-minute interval and the average number of steps taken, averaged across all days

```{r}
avg.steps <- aggregate(data.woNA$steps, list(interval=as.numeric(data.woNA$interval)), FUN="mean")
names(avg.steps)[2] <- "avgSteps"
ggplot(avg.steps, aes(interval, avgSteps)) + geom_line(color="orange") + labs(title="Time series plot of the average steps taken per 5-minute interval", x="Intervals", y="Average Number of Steps")
```

Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?

```{r}
avg.steps[which(avg.steps$avgSteps==max(avg.steps$avgSteps)), ]
```

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?

